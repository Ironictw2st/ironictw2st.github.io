<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Factions | 190 Expanded Wiki</title>
    <link rel="stylesheet" href="styles/tw3k.css">
</head>
<body>
    <div class="page-bg"></div>
    
    <header>
        <nav class="top-nav">
            <a href="../index.html" class="back-link">← Back to Hub</a>
        </nav>
        <div class="header-content">
            <p class="subtitle">190 Expanded Wiki</p>
            <h1>Factions</h1>
        </div>
    </header>

    <nav class="main-nav">
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="factions.html" class="active">Factions</a></li>
            <li><a href="characters.html">Characters</a></li>
            <li><a href="mechanics.html">Mechanics</a></li>
            <li><a href="changelog.html">Changelog</a></li>
        </ul>
    </nav>

    <main>
        <section class="intro">
            <p>"The empire, long divided, must unite; long united, must divide. Thus it has ever been."</p>
        </section>

        <!-- Major Han Warlords -->
        <section class="faction-category" data-category="warlords">
            <div class="category-header">
                <h2 class="category-title">
                    <span class="toggle-icon">▼</span>
                    Major Warlords
                    <span class="category-count">(12)</span>
                </h2>
            </div>
            <div class="faction-grid">
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Cao Cao</h3>
                    <p class="faction-leader">The Hero of Chaos</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Liu Bei</h3>
                    <p class="faction-leader">The Humble Ruler</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Sun Jian</h3>
                    <p class="faction-leader">The Tiger of Jiangdong</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Dong Zhuo</h3>
                    <p class="faction-leader">The Tyrant</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>

                <!-- Example override:
                     <article class="faction-card" data-type="han" data-loc-key="yuan_shao">
                -->
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Yuan Shao</h3>
                    <p class="faction-leader">The Dragon of the North</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>

                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Yuan Shu</h3>
                    <p class="faction-leader">The Pretender</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Lü Bu</h3>
                    <p class="faction-leader">The Warrior Without Equal</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Gongsun Zan</h3>
                    <p class="faction-leader">The Ironfist General</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Ma Teng</h3>
                    <p class="faction-leader">Protector of the West</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Liu Biao</h3>
                    <p class="faction-leader">Gentleman of the Han</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Liu Yan</h3>
                    <p class="faction-leader">Governor of Yi Province</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Kong Rong</h3>
                    <p class="faction-leader">The Scholarly Lord</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
            </div>
        </section>

        <!-- Han Empire & Governors -->
        <section class="faction-category" data-category="empire">
            <div class="category-header">
                <h2 class="category-title">
                    <span class="toggle-icon">▼</span>
                    Han Empire & Governors
                    <span class="category-count">(18)</span>
                </h2>
            </div>
            <div class="faction-grid">
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Han Empire</h3>
                    <p class="faction-leader">Emperor Xian</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Tao Qian</h3>
                    <p class="faction-leader">Governor of Xu Province</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Zhang Lu</h3>
                    <p class="faction-leader">The Celestial Master</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Shi Xie</h3>
                    <p class="faction-leader">King of Jiaozhi</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Liu Yu</h3>
                    <p class="faction-leader">Inspector of You Province</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Liu Yao</h3>
                    <p class="faction-leader">Governor of Yang Province</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Liu Dai</h3>
                    <p class="faction-leader">Governor of Yan Province</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Han Fu</h3>
                    <p class="faction-leader">Governor of Ji Province</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Han Sui</h3>
                    <p class="faction-leader">Warlord of Liang</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Wang Kuang</h3>
                    <p class="faction-leader">Administrator of Henei</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Wang Lang</h3>
                    <p class="faction-leader">Governor of Kuaiji</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Zhang Chao</h3>
                    <p class="faction-leader">Administrator of Guangling</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Zhang Yang</h3>
                    <p class="faction-leader">Administrator of Shangdang</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Cai Mao</h3>
                    <p class="faction-leader">General of Jingzhou</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Gao Gan</h3>
                    <p class="faction-leader">Governor of Bing Province</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Gongsun Du</h3>
                    <p class="faction-leader">Lord of Liaodong</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Huang Zu</h3>
                    <p class="faction-leader">Admiral of Jiangxia</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Kong Zhou</h3>
                    <p class="faction-leader">Governor of Yu Province</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
            </div>
        </section>

        <!-- A World Betrayed -->
        <section class="faction-category" data-category="dlc-awb">
            <div class="category-header">
                <h2 class="category-title">
                    <span class="toggle-icon">▼</span>
                    A World Betrayed
                    <span class="category-count">(8)</span>
                </h2>
            </div>
            <div class="faction-grid">
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Sun Ce</h3>
                    <p class="faction-leader">The Little Conqueror</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="bandit">
                    <h3 class="faction-name">Yan Baihu</h3>
                    <p class="faction-leader">The White Tiger</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Hua Xin</h3>
                    <p class="faction-leader">Administrator of Yuzhang</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Yang Feng</h3>
                    <p class="faction-leader">Former Yellow Turban</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Zhu Fu</h3>
                    <p class="faction-leader">Inspector of Jiao Province</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Wu Jing</h3>
                    <p class="faction-leader">Prefect of Danyang</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Sheng Xian</h3>
                    <p class="faction-leader">Defender of Xu Province</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Shi Huang</h3>
                    <p class="faction-leader">Defender of the People</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
            </div>
        </section>

        <!-- Fates Divided -->
        <section class="faction-category" data-category="dlc-fd">
            <div class="category-header">
                <h2 class="category-title">
                    <span class="toggle-icon">▼</span>
                    Fates Divided
                    <span class="category-count">(6)</span>
                </h2>
            </div>
            <div class="faction-grid">
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Prince Liu Chong</h3>
                    <p class="faction-leader">Prince of Chenliu</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Liu Xun</h3>
                    <p class="faction-leader">Governor of Lujiang</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Lü Kang</h3>
                    <p class="faction-leader">General of Lü Bu</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Chen Gui</h3>
                    <p class="faction-leader">Advisor of Xu Province</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Ying Shao</h3>
                    <p class="faction-leader">Scholar Official</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="bandit">
                    <h3 class="faction-name">Liang Rebels</h3>
                    <p class="faction-leader">Western Insurgents</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
            </div>
        </section>

        <!-- Yellow Turbans -->
        <section class="faction-category" data-category="yellow-turbans">
            <div class="category-header">
                <h2 class="category-title">
                    <span class="toggle-icon">▼</span>
                    Yellow Turbans
                    <span class="category-count">(5)</span>
                </h2>
            </div>
            <div class="faction-grid">
                <article class="faction-card" data-type="yellow-turban">
                    <h3 class="faction-name">Yellow Turban Rebels</h3>
                    <p class="faction-leader">The Way of Peace</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="yellow-turban">
                    <h3 class="faction-name">Taishan Yellow Turbans</h3>
                    <p class="faction-leader">Mountain Zealots</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="yellow-turban">
                    <h3 class="faction-name">Anding Yellow Turbans</h3>
                    <p class="faction-leader">Western Believers</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="yellow-turban">
                    <h3 class="faction-name">Generic Yellow Turbans</h3>
                    <p class="faction-leader">Scattered Faithful</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="yellow-turban">
                    <h3 class="faction-name">Yellow Turban Wuhuan</h3>
                    <p class="faction-leader">Nomadic Converts</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
            </div>
        </section>

        <!-- Bandits & Outlaws -->
        <section class="faction-category" data-category="bandits">
            <div class="category-header">
                <h2 class="category-title">
                    <span class="toggle-icon">▼</span>
                    Bandits & Outlaws
                    <span class="category-count">(5)</span>
                </h2>
            </div>
            <div class="faction-grid">
                <article class="faction-card" data-type="bandit">
                    <h3 class="faction-name">Zheng Jiang</h3>
                    <p class="faction-leader">The Bandit Queen</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="bandit">
                    <h3 class="faction-name">Zhang Yan</h3>
                    <p class="faction-leader">King of Black Mountain</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="bandit">
                    <h3 class="faction-name">Zhai Rong</h3>
                    <p class="faction-leader">Buddhist Warlord</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="bandit">
                    <h3 class="faction-name">Gan Ning</h3>
                    <p class="faction-leader">The Pirate King</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="bandit">
                    <h3 class="faction-name">Zu Lang</h3>
                    <p class="faction-leader">Raider Chief</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
            </div>
        </section>

        <!-- Nanman Tribes -->
        <section class="faction-category" data-category="nanman">
            <div class="category-header">
                <h2 class="category-title">
                    <span class="toggle-icon">▼</span>
                    Nanman Tribes
                    <span class="category-count">(14)</span>
                </h2>
            </div>
            <div class="faction-grid">
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">Meng Huo</h3>
                    <p class="faction-leader">King of the Nanman</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">Lady Zhurong</h3>
                    <p class="faction-leader">Daughter of the Fire God</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">King Shamoke</h3>
                    <p class="faction-leader">Wuling Barbarian King</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">King Mulu</h3>
                    <p class="faction-leader">Beastmaster King</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">King Duosi</h3>
                    <p class="faction-leader">Lord of Silver Mines</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">King Wutugu</h3>
                    <p class="faction-leader">Lord of Wugo</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">Jinhuansanjie</h3>
                    <p class="faction-leader">The Golden Ring</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">Dongtuna</h3>
                    <p class="faction-leader">Cave Dweller Chief</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">Ahuinan</h3>
                    <p class="faction-leader">Third Cave Chief</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">Tu An</h3>
                    <p class="faction-leader">Tribal Warrior</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">Xi Ni</h3>
                    <p class="faction-leader">Jungle Lord</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">Yang Feng (Nanman)</h3>
                    <p class="faction-leader">Nanman Chieftain</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">Mangyachang</h3>
                    <p class="faction-leader">Bamboo Tribe Chief</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">Jiuzhen</h3>
                    <p class="faction-leader">Southern Commander</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
            </div>
        </section>

        <!-- Shanyue & Southern Peoples -->
        <section class="faction-category" data-category="shanyue">
            <div class="category-header">
                <h2 class="category-title">
                    <span class="toggle-icon">▼</span>
                    Shanyue & Southern Peoples
                    <span class="category-count">(5)</span>
                </h2>
            </div>
            <div class="faction-grid">
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">Shanyue Rebels</h3>
                    <p class="faction-leader">Mountain Yue Tribes</p>
                    <div class="faction-tags"><span class="faction-tag dlc">DLC</span></div>
                </article>
                <article class="faction-card" data-type="nanman">
                    <h3 class="faction-name">Jia Long</h3>
                    <p class="faction-leader">Shanyue Chieftain</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Nanhai</h3>
                    <p class="faction-leader">Southern Commandery</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Yulin</h3>
                    <p class="faction-leader">Frontier Garrison</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Gaoliang</h3>
                    <p class="faction-leader">Southern Settlement</p>
                    <div class="faction-tags"><span class="faction-tag">Vanilla</span></div>
                </article>
            </div>
        </section>

        <!-- Northern Nomads -->
        <section class="faction-category" data-category="nomads">
            <div class="category-header">
                <h2 class="category-title">
                    <span class="toggle-icon">▼</span>
                    Northern Nomads
                    <span class="category-count">(9)</span>
                </h2>
            </div>
            <div class="faction-grid">
                <article class="faction-card" data-type="nomad">
                    <h3 class="faction-name">Xianbei - Kuitou</h3>
                    <p class="faction-leader">Xianbei Chanyu</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="nomad">
                    <h3 class="faction-name">Xianbei - Tuoba</h3>
                    <p class="faction-leader">Tuoba Clan</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="nomad">
                    <h3 class="faction-name">Wuhuan Tribes</h3>
                    <p class="faction-leader">Eastern Nomads</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="nomad">
                    <h3 class="faction-name">Xiongnu Tribes</h3>
                    <p class="faction-leader">The Great Horde</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="nomad">
                    <h3 class="faction-name">Di Tribes</h3>
                    <p class="faction-leader">Northwestern Peoples</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="nomad">
                    <h3 class="faction-name">Shitla</h3>
                    <p class="faction-leader">Steppe Warriors</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="nomad">
                    <h3 class="faction-name">Bakaja</h3>
                    <p class="faction-leader">Northern Raiders</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="nomad">
                    <h3 class="faction-name">You Tu</h3>
                    <p class="faction-leader">Nomad Chieftain</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="nomad">
                    <h3 class="faction-name">Zhang Jin (Border)</h3>
                    <p class="faction-leader">Frontier Commander</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
            </div>
        </section>

        <!-- Korean Kingdoms -->
        <section class="faction-category" data-category="korean">
            <div class="category-header">
                <h2 class="category-title">
                    <span class="toggle-icon">▼</span>
                    Korean Kingdoms
                    <span class="category-count">(5)</span>
                </h2>
            </div>
            <div class="faction-grid">
                <article class="faction-card" data-type="korean">
                    <h3 class="faction-name">Goguryeo</h3>
                    <p class="faction-leader">Kingdom of the North</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="korean">
                    <h3 class="faction-name">Buyeo</h3>
                    <p class="faction-leader">Ancient Kingdom</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="korean">
                    <h3 class="faction-name">Korea - Ye</h3>
                    <p class="faction-leader">Eastern Tribe</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="korean">
                    <h3 class="faction-name">Gaya</h3>
                    <p class="faction-leader">Confederacy</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="korean">
                    <h3 class="faction-name">Tamno</h3>
                    <p class="faction-leader">Island Kingdom</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
            </div>
        </section>

        <!-- Minor Factions -->
        <section class="faction-category" data-category="minor">
            <div class="category-header">
                <h2 class="category-title">
                    <span class="toggle-icon">▼</span>
                    Minor Factions
                    <span class="category-count">(15)</span>
                </h2>
            </div>
            <div class="faction-grid">
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Zhuge Xuan</h3>
                    <p class="faction-leader">Uncle of Zhuge Liang</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Fei Zhan</h3>
                    <p class="faction-leader">Local Administrator</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Zhao Wei</h3>
                    <p class="faction-leader">Provincial Official</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Zhang Jin</h3>
                    <p class="faction-leader">Regional Commander</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Ma Ai</h3>
                    <p class="faction-leader">Western Lord</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Zhang Xian</h3>
                    <p class="faction-leader">Military Governor</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Chen Wen</h3>
                    <p class="faction-leader">Local Magnate</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Zhu Hao</h3>
                    <p class="faction-leader">Southern Administrator</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Bian Rang</h3>
                    <p class="faction-leader">Scholar Lord</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Tong Zhi</h3>
                    <p class="faction-leader">Regional Leader</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Liu Pan</h3>
                    <p class="faction-leader">Frontier Governor</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Su Dai</h3>
                    <p class="faction-leader">Minor Official</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Wang Sheng</h3>
                    <p class="faction-leader">Landowner</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Huang Clan</h3>
                    <p class="faction-leader">Noble Family</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
                <article class="faction-card" data-type="han">
                    <h3 class="faction-name">Hu Mao</h3>
                    <p class="faction-leader">Local Strongman</p>
                    <div class="faction-tags"><span class="faction-tag modded">190 Expanded</span></div>
                </article>
            </div>
        </section>

    </main>

    <footer>
        <p>190 Expanded Wiki · Created by Ironic</p>
    </footer>

    <script>
        // Toggle category collapse
        document.querySelectorAll('.category-header').forEach(header => {
            header.addEventListener('click', () => {
                const category = header.closest('.faction-category');
                category.classList.toggle('collapsed');
            });
        });

        // ===== Titles from TSV =====
        // Rule:
        //  - faction-name: "Yuan Shao"
        //  - loc key default: "yuan_shao"
        //  - find a TSV row whose key contains: career + title + yuan_shao
        // Override:
        //  - <article class="faction-card" data-loc-key="yuan_shao">
        //  - OR <h3 class="faction-name" data-loc-key="yuan_shao">

        function slugifyToLocKey(name) {
            return (name || "")
                .toLowerCase()
                .normalize("NFKD")
                .replace(/[\u0300-\u036f]/g, "") // remove diacritics
                .replace(/['’]/g, "")           // remove apostrophes
                .replace(/[^a-z0-9]+/g, "_")     // non-alnum -> _
                .replace(/^_+|_+$/g, "")         // trim underscores
                .replace(/_+/g, "_");            // collapse
        }

        function parseLocTsv(tsvText) {
            // Expected: key \t value (optionally more cols, we keep first 2)
            const map = new Map();

            const lines = tsvText.split(/\r?\n/);
            for (const line of lines) {
                if (!line) continue;
                if (line.startsWith("#")) continue;

                const cols = line.split("\t");
                if (cols.length < 2) continue;

                const key = (cols[0] || "").trim();
                const val = (cols[1] || "").trim();

                if (!key) continue;
                // Keep the first seen; if you want "last wins", replace this condition.
                if (!map.has(key)) map.set(key, val);
            }

            return map;
        }

        function findBestCareerTitle(locMap, locKey) {
            const want = (locKey || "").toLowerCase();
            if (!want) return null;

            // Candidate keys: must contain career + title + locKey
            const candidates = [];
            for (const [k, v] of locMap.entries()) {
                const lk = k.toLowerCase();
                if (lk.includes("career") && lk.includes("title") && lk.includes(want)) {
                    candidates.push({ k, v, lk });
                }
            }
            if (!candidates.length) return null;

            // Prefer very direct patterns first, then shortest key as tie-break.
            const preferredPrefixes = [
                `career_title_${want}`,
                `career_title_${want}_`,
                `career_title_${want}.`,
                `career_title_${want}-`,
                `career_title_${want}__`
            ];

            candidates.sort((a, b) => {
                const aScore =
                    preferredPrefixes.some(p => a.lk.includes(p)) ? 0 :
                    a.lk.includes(`career_title_`) ? 1 : 2;
                const bScore =
                    preferredPrefixes.some(p => b.lk.includes(p)) ? 0 :
                    b.lk.includes(`career_title_`) ? 1 : 2;

                if (aScore !== bScore) return aScore - bScore;
                return a.k.length - b.k.length;
            });

            return candidates[0].v || null;
        }

        async function fetchFirstOk(urls) {
            let lastErr = null;
            for (const url of urls) {
                try {
                    const res = await fetch(url, { cache: "no-cache" });
                    if (!res.ok) {
                        lastErr = new Error(`HTTP ${res.status} for ${url}`);
                        continue;
                    }
                    return await res.text();
                } catch (e) {
                    lastErr = e;
                }
            }
            throw lastErr || new Error("Failed to fetch TSV");
        }

        async function applyTitlesFromTsv() {
            // Try a few likely paths so you don't have to care whether factions.html
            // lives in /total_war/ or root.
            const tsvUrls = [
                "data/all_titles_full.loc.tsv",
                "../data/all_titles_full.loc.tsv",
                "../../data/all_titles_full.loc.tsv",
                // Absolute fallback (works even if file is elsewhere)
                "https://raw.githubusercontent.com/Ironictw2st/ironictw2st.github.io/main/data/all_titles_full.loc.tsv"
            ];

            const tsvText = await fetchFirstOk(tsvUrls);
            const locMap = parseLocTsv(tsvText);

            document.querySelectorAll(".faction-card").forEach(card => {
                const nameEl = card.querySelector(".faction-name");
                const leaderEl = card.querySelector(".faction-leader");
                if (!nameEl || !leaderEl) return;

                const factionName = (nameEl.textContent || "").trim();
                if (!factionName) return;

                const overrideKey =
                    (card.dataset.locKey && card.dataset.locKey.trim()) ||
                    (nameEl.dataset.locKey && nameEl.dataset.locKey.trim()) ||
                    "";

                const locKey = overrideKey || slugifyToLocKey(factionName);

                const title = findBestCareerTitle(locMap, locKey);
                if (title) {
                    leaderEl.textContent = title;
                    // optional: expose what key was used for debugging
                    card.dataset.resolvedLocKey = locKey;
                }
            });
        }

        document.addEventListener("DOMContentLoaded", () => {
            applyTitlesFromTsv().catch(err => {
                console.warn("[Titles TSV] Failed to apply titles:", err);
            });
        });
    </script>
</body>
</html>
